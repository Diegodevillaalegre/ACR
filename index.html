<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TEST Interactivos: Fibromialgia (2016) y Artritis Reumatoide (ACR/EULAR 2010)</title>
<style>
  :root{
    --bg:#0f172a; /* slate-900 */
    --panel:#111827; /* gray-900 */
    --card:#0b1220; /* darker */
    --text:#e5e7eb; /* gray-200 */
    --muted:#94a3b8; /* slate-400 */
    --accent:#38bdf8; /* sky-400 */
    --accent-2:#22c55e; /* green-500 */
    --accent-3:#f59e0b; /* amber-500 */
    --danger:#ef4444; /* red-500 */
  }
  html,body{height:100%;}
  body{margin:0;background:linear-gradient(180deg,var(--bg),#0b1020);color:var(--text);font:16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"}
  .wrap{max-width:1100px;margin:0 auto;padding:24px}
  header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
  .title{font-size:1.4rem;font-weight:700;letter-spacing:.3px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap}
  .tab{border:1px solid #1f2937;background:#0b1220;border-radius:999px;padding:8px 14px;color:var(--muted);cursor:pointer;user-select:none}
  .tab.active{color:#0b1220;background:var(--accent);border-color:var(--accent)}
  .grid{display:grid;grid-template-columns:1fr;gap:16px}
  @media(min-width:980px){.grid{grid-template-columns:1.1fr .9fr}}
  .card{background:linear-gradient(180deg,#0b1220,#0a0f1a);border:1px solid #1f2937;border-radius:14px;padding:18px}
  h2{font-size:1.1rem;margin:0 0 8px}
  h3{font-size:1rem;margin:16px 0 8px;color:var(--muted)}
  .section-help{font-size:.9rem;color:var(--muted)}
  .cols{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}
  .cols-3{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
  .item{border:1px solid #223049;border-radius:10px;padding:10px}
  .item label{display:flex;gap:8px;align-items:center}
  .score{font-size:2rem;font-weight:800}
  .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:.8rem;border:1px solid #1f2937}
  .ok{background:rgba(34,197,94,.15);color:#86efac;border-color:#14532d}
  .warn{background:rgba(245,158,11,.15);color:#fcd34d;border-color:#78350f}
  .bad{background:rgba(239,68,68,.15);color:#fecaca;border-color:#7f1d1d}
  .btn{appearance:none;border:1px solid #1f2937;background:#0b1220;color:var(--text);padding:10px 14px;border-radius:10px;cursor:pointer}
  .btn:hover{border-color:#334155}
  .btn-accent{background:var(--accent);color:#0b1220;border-color:transparent}
  .muted{color:var(--muted)}
  .foot{margin-top:24px;font-size:.9rem;color:var(--muted)}
  details summary{cursor:pointer;color:var(--accent)}
  .divider{height:1px;background:#1f2937;margin:12px 0}
  .legend{font-size:.9rem;color:var(--muted)}
  .pill{display:inline-block;border:1px dashed #334155;border-radius:999px;padding:4px 8px;margin:2px}
  .list{margin:8px 0;padding-left:18px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">TEST interactivos para consulta general: Fibromialgia (2016) y Artritis Reumatoide (ACR/EULAR 2010)</div>
      <div>
        <button class="btn" onclick="window.print()">Imprimir</button>
      </div>
    </header>

    <nav class="tabs" role="tablist" aria-label="Selector de test">
      <button class="tab active" id="tab-fm" onclick="showTab('fm')">Fibromialgia 2016</button>
      <button class="tab" id="tab-ra" onclick="showTab('ra')">AR ACR/EULAR 2010</button>
    </nav>

    <!-- Fibromialgia -->
    <section id="fm" class="tab-panel" aria-labelledby="tab-fm">
      <div class="grid">
        <div class="card">
          <h2>1) WPI: Índice de dolor generalizado (0–19) — última semana</h2>
          <p class="section-help">Seleccione las zonas con dolor. Se suman hasta 19 sitios. Para <strong>dolor generalizado</strong>, se contabilizan regiones anatómicas: superior izquierda, superior derecha, inferior izquierda, inferior derecha y axial. <span class="muted">Nota: pecho y abdomen no cuentan para “dolor generalizado” pero sí para WPI.</span></p>

          <h3>Axial</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-wpi data-region="axial" /> Cuello</label>
            <label class="item"><input type="checkbox" data-wpi data-region="axial" /> Espalda alta</label>
            <label class="item"><input type="checkbox" data-wpi data-region="axial" /> Espalda baja</label>
            <label class="item"><input type="checkbox" data-wpi data-omit-region="true" /> Pecho</label>
            <label class="item"><input type="checkbox" data-wpi data-omit-region="true" /> Abdomen</label>
          </div>

          <h3>Superior izquierda</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-wpi data-region="Lsup" /> Mandíbula izq.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Lsup" /> Cintura escapular izq.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Lsup" /> Brazo izq. proximal</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Lsup" /> Antebrazo izq.</label>
          </div>

          <h3>Superior derecha</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-wpi data-region="Rsup" /> Mandíbula der.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Rsup" /> Cintura escapular der.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Rsup" /> Brazo der. proximal</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Rsup" /> Antebrazo der.</label>
          </div>

          <h3>Inferior izquierda</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-wpi data-region="Linf" /> Cadera/glúteo izq.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Linf" /> Muslo izq.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Linf" /> Pierna izq.</label>
          </div>

          <h3>Inferior derecha</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-wpi data-region="Rinf" /> Cadera/glúteo der.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Rinf" /> Muslo der.</label>
            <label class="item"><input type="checkbox" data-wpi data-region="Rinf" /> Pierna der.</label>
          </div>

          <div class="divider"></div>
          <div class="legend">
            <span class="pill">WPI: suma de sitios = 0–19</span>
            <span class="pill">Dolor generalizado: ≥4 de 5 regiones con dolor</span>
          </div>
        </div>

        <div class="card">
          <h2>2) SSS: Severidad de síntomas (0–12)</h2>
          <div class="cols">
            <div class="item">
              <label>Fatiga</label>
              <input type="range" min="0" max="3" step="1" value="0" data-sss="fatiga" oninput="updateLabels()" />
              <div class="muted">0–3</div>
            </div>
            <div class="item">
              <label>Despertar no reparador</label>
              <input type="range" min="0" max="3" step="1" value="0" data-sss="sueño" oninput="updateLabels()" />
              <div class="muted">0–3</div>
            </div>
            <div class="item">
              <label>Síntomas cognitivos</label>
              <input type="range" min="0" max="3" step="1" value="0" data-sss="cognitivo" oninput="updateLabels()" />
              <div class="muted">0–3</div>
            </div>
          </div>

          <h3>Síntomas acompañantes</h3>
          <div class="cols">
            <label class="item"><input type="checkbox" data-sss-extra /> Cefalea</label>
            <label class="item"><input type="checkbox" data-sss-extra /> Dolor/cólicos en hipogastrio</label>
            <label class="item"><input type="checkbox" data-sss-extra /> Ánimo deprimido</label>
          </div>

          <h3>Duración</h3>
          <div class="item">
            <label><input type="checkbox" id="fm-3m" /> Síntomas ≥ 3 meses</label>
          </div>
        </div>
      </div>

      <div class="grid" style="margin-top:16px">
        <div class="card">
          <h2>Resultado Fibromialgia</h2>
          <div class="cols-3">
            <div>
              <div class="muted">WPI</div>
              <div class="score" id="fm-wpi">0</div>
            </div>
            <div>
              <div class="muted">SSS</div>
              <div class="score" id="fm-sss">0</div>
            </div>
            <div>
              <div class="muted">Regiones con dolor</div>
              <div class="score" id="fm-reg">0/5</div>
            </div>
          </div>
          <div style="margin-top:8px">
            <span id="fm-criteria" class="badge warn">Criterios incompletos</span>
            <span id="fm-prob" class="badge"></span>
          </div>
          <div class="divider"></div>
          <div id="fm-explain" class="section-help"></div>
        </div>
        <div class="card">
          <h2>Conducta sugerida</h2>
          <ul class="list" id="fm-manejo"></ul>
          <details>
            <summary>Notas para APS</summary>
            <ul class="list">
              <li>Evaluar comorbilidades: ánimo, trastornos del sueño, dolor lumbar crónico, SII.</li>
              <li>Evitar estudios extensos si clínica típica y examen normal.</li>
              <li>Derivar a Reumatología cuando el diagnóstico sea dudoso, existan signos inflamatorios objetivos o impacto funcional severo refractario.</li>
            </ul>
          </details>
        </div>
      </div>
    </section>

    <!-- AR ACR/EULAR 2010 -->
    <section id="ra" class="tab-panel" aria-labelledby="tab-ra" hidden>
      <div class="grid">
        <div class="card">
          <h2>Puntaje por categorías A–D</h2>
          <h3>A. Compromiso articular</h3>
          <div class="cols">
            <label class="item"><input type="radio" name="ra-A" value="0" checked> 1 articulación grande (0)</label>
            <label class="item"><input type="radio" name="ra-A" value="1"> 2–10 grandes (1)</label>
            <label class="item"><input type="radio" name="ra-A" value="2"> 1–3 pequeñas ± grandes (2)</label>
            <label class="item"><input type="radio" name="ra-A" value="3"> 4–10 pequeñas ± grandes (3)</label>
            <label class="item"><input type="radio" name="ra-A" value="5"> &gt;10 articulaciones (≥1 pequeña) (5)</label>
          </div>

          <h3>B. Serología (RF/ACPA)</h3>
          <div class="cols">
            <label class="item"><input type="radio" name="ra-B" value="0" checked> RF− y ACPA− (0)</label>
            <label class="item"><input type="radio" name="ra-B" value="2"> RF+ o ACPA+ bajo título (2)</label>
            <label class="item"><input type="radio" name="ra-B" value="3"> RF+ o ACPA+ alto título (3)</label>
          </div>

          <h3>C. Reactantes de fase aguda</h3>
          <div class="cols">
            <label class="item"><input type="radio" name="ra-C" value="0" checked> PCR y VSG normales (0)</label>
            <label class="item"><input type="radio" name="ra-C" value="1"> PCR o VSG anormal (1)</label>
          </div>

          <h3>D. Duración de síntomas</h3>
          <div class="cols">
            <label class="item"><input type="radio" name="ra-D" value="0" checked> &lt; 6 semanas (0)</label>
            <label class="item"><input type="radio" name="ra-D" value="1"> ≥ 6 semanas (1)</label>
          </div>
        </div>

        <div class="card">
          <h2>Resultado AR</h2>
          <div class="cols-3">
            <div>
              <div class="muted">Puntaje total</div>
              <div class="score" id="ra-total">0</div>
            </div>
            <div>
              <div class="muted">Clasificación</div>
              <div class="score" id="ra-clas">No cumple</div>
            </div>
            <div>
              <div class="muted">Probabilidad</div>
              <div class="score" id="ra-prob">Baja</div>
            </div>
          </div>
          <div class="divider"></div>
          <div id="ra-explain" class="section-help"></div>
        </div>
      </div>

      <div class="grid" style="margin-top:16px">
        <div class="card">
          <h2>Conducta sugerida</h2>
          <ul class="list" id="ra-manejo"></ul>
          <details>
            <summary>Notas clínicas</summary>
            <ul class="list">
              <li>Un puntaje ≥6/10 clasifica AR definida; la decisión terapéutica requiere confirmación clínica.</li>
              <li>Si el puntaje es &lt;6 pero existe sinovitis clínica persistente, considerar reevaluación seriada y derivación.</li>
            </ul>
          </details>
        </div>
      </div>
    </section>

    <section class="foot">
      <div><strong>Uso:</strong> herramienta educativa y de apoyo a la decisión en APS. No reemplaza juicio clínico ni examen físico. Evitar automatizar prescripción farmacológica desde aquí.</div>
      <div style="margin-top:8px">
        <strong>Fuentes:</strong> Criterios diagnósticos de Fibromialgia 2016 (WPI/SSS) y Criterios de clasificación de AR ACR/EULAR 2010. Consulte literatura vigente para matices clínicos.
      </div>
    </section>
  </div>

<script>
  // Tab logic
  function showTab(key){
    const ids=["fm","ra"]; ids.forEach(id=>{document.getElementById(id).hidden = id!==key});
    document.querySelectorAll('.tab').forEach(btn=>btn.classList.remove('active'));
    document.getElementById('tab-'+key).classList.add('active');
    updateAll();
  }

  // Fibromialgia calculators
  const fm = {
    wpiSites: Array.from(document.querySelectorAll('[data-wpi]')),
    sssSliders: Array.from(document.querySelectorAll('[data-sss]')),
    sssExtras: Array.from(document.querySelectorAll('[data-sss-extra]')),
    threeMonths: document.getElementById('fm-3m')
  };

  function computeFM(){
    // WPI count
    const wpi = fm.wpiSites.filter(x=>x.checked).length;

    // Regions: Lsup, Rsup, Linf, Rinf, axial; exclude items with data-omit-region
    const regionSet = new Set();
    fm.wpiSites.forEach(x=>{
      const omit = x.hasAttribute('data-omit-region');
      const r = x.getAttribute('data-region');
      if(x.checked && r && !omit){ regionSet.add(r); }
    });
    const regions = regionSet.size; // 0-5

    // SSS
    let sssCore = fm.sssSliders.reduce((a,x)=>a + Number(x.value), 0); // 0-9
    let sssExtra = fm.sssExtras.filter(x=>x.checked).length; // 0-3
    if(sssExtra>3) sssExtra=3; // cap
    const sss = sssCore + sssExtra; // 0-12

    // Criteria
    const crit1 = (wpi>=7 && sss>=5) || (wpi>=4 && wpi<=6 && sss>=9);
    const crit2 = regions>=4; // generalized pain in 4/5 regions
    const crit3 = fm.threeMonths.checked;
    const meets = crit1 && crit2 && crit3;

    // Probability labeling (heuristic for UI only)
    let probTxt = 'Baja'; let badge='warn';
    if(meets){ probTxt='Alta'; badge='ok'; }
    else if(crit1 || crit2 || crit3){ probTxt='Intermedia'; badge='warn'; }
    else { probTxt='Baja'; badge='bad'; }

    // Update UI
    document.getElementById('fm-wpi').textContent = wpi;
    document.getElementById('fm-sss').textContent = sss;
    document.getElementById('fm-reg').textContent = regions + '/5';

    const critEl = document.getElementById('fm-criteria');
    critEl.textContent = meets ? 'Cumple criterios diagnósticos' : 'Criterios incompletos';
    critEl.className = 'badge ' + (meets ? 'ok' : 'warn');

    const probEl = document.getElementById('fm-prob');
    probEl.textContent = 'Probabilidad: ' + probTxt;
    probEl.className = 'badge ' + (probTxt==='Alta'?'ok':probTxt==='Intermedia'?'warn':'bad');

    const explain = document.getElementById('fm-explain');
    explain.innerHTML =
      `<strong>Regla:</strong> WPI ≥ 7 y SSS ≥ 5, o WPI 4–6 y SSS ≥ 9; además dolor generalizado en ≥4/5 regiones y síntomas ≥3 meses.`;

    // Management suggestions for primary care
    const manejo = document.getElementById('fm-manejo');
    manejo.innerHTML = '';
    const li = (t)=>{const el=document.createElement('li'); el.textContent=t; manejo.appendChild(el);};
    if(meets){
      li('Educar en dolor crónico central: validar síntomas y explicar fisiopatología no inflamatoria.');
      li('Indicar actividad física progresiva: aeróbico + fortalecimiento 2–3 veces/semana.');
      li('Higiene del sueño y regularidad del ritmo circadiano.');
      li('Considerar terapia psicológica con enfoque cognitivo-conductual según disponibilidad.');
      li('Cribar y tratar comorbilidades: ánimo, sueño, SII, cefalea.');
      li('Derivar a Reumatología si diagnóstico atípico, signos objetivos inflamatorios o discapacidad marcada persistente.');
    } else if(crit1 || crit2) {
      li('Re-evaluar en 4–8 semanas con énfasis en actividad física y sueño.');
      li('Completar anamnesis dirigida y examen físico para descartar patología inflamatoria.');
      li('Derivar si aparecen sinovitis objetiva, rigidez matinal prolongada o elevación de reactantes.');
    } else {
      li('Fomentar ejercicio y hábitos de sueño.');
      li('Seguimiento clínico si persisten síntomas.');
    }
  }

  fm.wpiSites.forEach(x=>x.addEventListener('change', computeFM));
  fm.sssSliders.forEach(x=>x.addEventListener('change', computeFM));
  fm.sssExtras.forEach(x=>x.addEventListener('change', computeFM));
  fm.threeMonths.addEventListener('change', computeFM);

  function updateLabels(){ /* reserved for live slider labels if needed */ }

  // RA calculator
  const raInputs = Array.from(document.querySelectorAll('input[name^="ra-"]'));
  function computeRA(){
    const A = Number(document.querySelector('input[name="ra-A"]:checked').value);
    const B = Number(document.querySelector('input[name="ra-B"]:checked').value);
    const C = Number(document.querySelector('input[name="ra-C"]:checked').value);
    const D = Number(document.querySelector('input[name="ra-D"]:checked').value);
    const total = A+B+C+D;

    const clas = total>=6 ? 'AR definida (clasificación)' : 'No cumple';
    let prob='Baja';
    if(total>=6) prob='Alta'; else if(total>=3) prob='Intermedia';

    document.getElementById('ra-total').textContent = total;
    document.getElementById('ra-clas').textContent = clas;
    document.getElementById('ra-prob').textContent = prob;

    const explain=document.getElementById('ra-explain');
    explain.innerHTML = `<strong>Regla:</strong> Sumar A–D. Puntaje ≥6/10 clasifica como AR. La probabilidad mostrada es orientativa y no reemplaza el juicio clínico.`;

    const manejo=document.getElementById('ra-manejo'); manejo.innerHTML='';
    const li=(t)=>{const el=document.createElement('li'); el.textContent=t; manejo.appendChild(el);};
    if(total>=6){
      li('Derivación precoz a Reumatología para confirmación diagnóstica y planificación terapéutica.');
      li('Solicitar hemograma, perfil hepatorrenal, PCR/VSG, función tiroidea si clínicamente pertinente.');
      li('Imagen: radiografía de manos y pies de base o ecografía articular si disponible.');
      li('Educar en autocuidado articular y promover ejercicio de bajo impacto.');
    } else if(total>=3){
      li('Reevaluación seriada: buscar sinovitis objetiva y seguimiento de rigidez matinal y dolor inflamatorio.');
      li('Completar serologías (RF/ACPA) si faltan y reactantes de fase aguda.');
      li('Considerar derivación si clínica sugiere progresión o compromiso funcional.');
    } else {
      li('Manejo sintomático no farmacológico y vigilancia clínica.');
      li('Si aparece tumefacción articular o signos inflamatorios, reevaluar criterios.');
    }
  }
  raInputs.forEach(x=>x.addEventListener('change', computeRA));

  function updateAll(){ computeFM(); computeRA(); }
  updateAll();
</script>
</body>
</html>
